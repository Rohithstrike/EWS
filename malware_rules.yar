rule ExampleMalwareRule {
    meta:
        severity = "medium"
        description = "Generic malware detection"
        threat_type = "generic"
    strings:
        $malicious_string = "malicious_pattern"
        $suspicious_cmd = "cmd.exe"
        $suspicious_registry = "HKEY_LOCAL_MACHINE"
        $network_activity = "http://example.com/malicious_payload"
    condition:
        $malicious_string or ($suspicious_cmd and $suspicious_registry) or $network_activity
}

rule AdvancedMalwareRule {
    meta:
        severity = "high"
        description = "Advanced malware behavior detection"
        threat_type = "advanced_persistent_threat"
    strings:
        $apt_string = "APT_malicious_pattern"
        $network_activity = "http://malicious-site.com"
        $c2_domain = "http://example-apt-c2.com"
        $encrypted_data = {68 74 74 70 73 3A 2F 2F}
    condition:
        $apt_string or $network_activity or $c2_domain or $encrypted_data
}

rule LowRiskMalwareRule {
    meta:
        severity = "low"
        description = "Low-risk malware detection"
        threat_type = "low_risk"
    strings:
        $low_risk_string = "low_risk_malicious_pattern" // Generic low-risk pattern
        $info_gathering_cmd = "whoami"                  // Command often used in information gathering
        $unusual_file_extension = ".tmp"                // Temporary files which might be misused
    condition:
        $low_risk_string or $info_gathering_cmd or $unusual_file_extension
}