rule ExampleMalwareRule {
  meta:
    severity = "medium"
    description = "Generic malware detection"
    threat_type = "generic"
  strings:
    $malicious_string = "malicious_pattern"  // Main malicious string pattern
    $suspicious_cmd = "cmd.exe"              // Suspicious command execution
    $suspicious_registry = "HKEY_LOCAL_MACHINE" // Possible registry manipulation
  condition:
    $malicious_string or ($suspicious_cmd and $suspicious_registry)
}

rule AdvancedMalwareRule {
  meta:
    severity = "high"
    description = "Advanced malware behavior detection"
    threat_type = "advanced_persistent_threat"
  strings:
    $apt_string = "APT_malicious_pattern"    // Advanced persistent threat indicator
    $network_activity = "http://malicious-site.com" // Malicious network activity example
    $encrypted_data = {68 74 74 70 73 3A 2F 2F} // Hex pattern for "https://"
  condition:
    $apt_string or $network_activity or $encrypted_data
}

rule RansomwareDetection {
  meta:
    severity = "critical"
    description = "Ransomware detection rule"
    threat_type = "ransomware"
  strings:
    $ransom_note = "Your files have been encrypted" // Ransom message pattern
    $decrypt_instructions = "decrypt"               // Indicator of decryption instructions
    $bitcoin_address = /1[1-9A-HJ-NP-Za-km-z]{25,34}/ // Bitcoin address regex pattern
  condition:
    $ransom_note or $decrypt_instructions or $bitcoin_address
}