rule ExampleMalwareRule {
  meta:
    severity = "medium"
    description = "Generic malware detection"
    threat_type = "generic"
  strings:
    $malicious_string = "malicious_pattern"  // Make sure the string is properly terminated
  condition:
    $malicious_string
}

rule AdvancedMalwareRule {
  meta:
    severity = "high"
    description = "Advanced malware behavior"
    threat_type = "advanced_persistent_threat"
  strings:
    $apt_string = "APT_malicious_pattern"
  condition:
    $apt_string
}

rule RansomwareDetection {
  meta:
    severity = "critical"
    description = "Ransomware detection rule"
    threat_type = "ransomware"
  strings:
    $ransom_note = "Your files have been encrypted"
    $bitcoin_address = /1[1-9A-HJ-NP-Za-km-z]{25,34}/
  condition:
    $ransom_note or $bitcoin_address
}